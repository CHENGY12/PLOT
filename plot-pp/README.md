# PLOT++
This folder contains the implementation of the PLOT++ method which extends PLOT to support the ViT backbones. Models are coming (in two days). 


## Build Environment
Following CoOp, it is needed to install the 'dassl' environment. You can follow the scripts [Dassl](https://github.com/KaiyangZhou/Dassl.pytorch#installation) to install `dassl` as well as PyTorch. Then, you can install other package by running `pip install -r requirements.txt` (this should be done when `dassl` is activated).


## Install Dataset
Please follow the instructions [DATASETS.md](https://github.com/KaiyangZhou/CoOp/blob/main/DATASETS.md) to construct the datasets.


## Run Scripts


Our `PLOT++` includes two stages, both two running scripts are in `scripts/`. 

To run the first stage, you should firstly run `cd ./scripts` and change `your_data_path` and `your_work_path` in `scripts/main_visiononly.sh`, then you can run the commands `bash main_visiononly.sh DATASET M` under `plot-pp/scripts/`. For example `bash bash main_visiononly.sh caltech101 4`

`DATASET` takes as input a dataset name, like `caltech101`. 

M is the number of vision prompts, such as 4.

After the first stage, you can find the results from `output_visiononly/`, whose structure is
```
output
|–– OP_N4/caltech101/
|   |–– PLOTPP/
|   |   |–– vit_16shots/
|   |   |   |–– nctx4_cscFalse_ctpend/
|   |   |   |   |–– seed1/
|   |   |   |   |–– seed2/
|   |   |   |   |–– seed3/
|   |   |–– vit_8shots/
|   |   |   |–– nctx4_cscFalse_ctpend/
|   |   |   |   |–– seed1/
|   |   |   |   |–– seed2/
|   |   |   |   |–– seed3/
```
you can find the first-stage pretrained model from `seed1/visiononly/model.pth.tar-50`.

To run the second stage, you should change `your_data_path`, `your_pretrain_path` and `your_work_path` in `scripts/main_joint.sh`, then you can run the commands `bash main_joint.sh DATASET M` under `plot-pp/scripts/`. For example `bash main_joint.sh caltech101 4`

Note that `DATASET` and `M` should have the same values as the fist stage.

### Results

You can find the results from `output_joint/` whose structure is

```
output_joint
|–– OP_N4/caltech101/
|   |–– PLOTPP/
|   |   |–– vit_16shots/
|   |   |   |–– nctx4_cscFalse_ctpend/
|   |   |   |   |–– seed1/
|   |   |   |   |–– seed2/
|   |   |   |   |–– seed3/
|   |   |–– vit_8shots/
|   |   |   |–– nctx4_cscFalse_ctpend/
|   |   |   |   |–– seed1/
|   |   |   |   |–– seed2/
|   |   |   |   |–– seed3/
```


## Evaluation

Results reported below show accuracy across 11 recognition datasets averaged over 1 2 4 8 16 shots, you can download corresponding vision-only models (stage1) and joint-train models (stage2) through links given in corresponding columns.

| Dataset      | 1shots | links | 2shots | links | 4shots | links | 8shots | links | 16shots | links |
|------------  |:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
| Caltech101   | 93.14 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EheavZiQsb9Fr8FwN5qhmBwBTrhnETrty5QiNENH7RV3ow?e=5x8GRG);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eu3gXZ1wvcdDngL_dLfkvG4BA2fRru97wwEEp5b0pO64Ew?e=qDyUWH) | 94.69 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EhPKLWorAKJPnQY1JsUuJT8B-ccm1yIojjsxMdVaNz1VEg?e=4YdPtX);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ejey2xegxb5Plcfz3t3GWMkBrFby-o6AHJiRlygZgGt_4A?e=wG0Y53) | 95.13 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eh6jgvGXX6NPr4NNZuTdvJkB1yPSZiOGSy341IpoENv--Q?e=bx5GbP);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EhvqfRlSr0JPnsezIX35C1IBjeVI06HqgvJWZHcCPwDm6w?e=1RQNGY) | 95.51 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/El0HsCEnB3BGmLmrvy3yADIBQOOFyZpCHGBeKaL2jUDOaA?e=YvkjEK);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErTfoBioVXBIqaetAU5lKooBVOa1zw7xQ8WibDvdc_60LQ?e=sRnoZe) | 96.04 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EjWge1Nl37NDh--KDeG8uFoBlAphiVN_PQLuGzffgQZzIA?e=anVuDx);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EqG32ZFa5_BNm2dKzrp36ssBp6QJ1CR4mufqhlbhcX6Q_g?e=8WlDYY) |
| DTD          | 54.57 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EnJgGyc5pQdFkjH3pMBrlloBY-sUxOf1v-ArfhizGWGIVA?e=2cT0F4);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ekcztf1hWapFtDqimh-xw8gBjxR2HtpXFrj4PoUHzLuExA?e=ZgDXSa) | 56.72 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Es5zpZXl0xlNkyMw0YYo5DwBhU7e30h2GzCkdVJprTJyGw?e=Y4f0TO);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EooMcLbtm-9JleAuqZkoFa8BaYZkvFarFj3uP8t1MzfTKA?e=vXe2w8) | 62.43 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EoVMzallQYFMi4zq9z5NI3ABjQjtERV9bX5-hSPj340U8A?e=fsCPNU);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EnOLR276_VRGpYZnJ11fcuABw3CYykzNvNZti0_ZOlyXJg?e=FCjBqc) | 66.49 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Es1MZMOZoutLjItdMLEcB54BVseOHKKOONKvKdoF2jtikg?e=Tjbx7S);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Egmit7nBzX5MtmdpmLSqNLUBaAliNfYf3JtNjhX7B3ujPQ?e=0h0dMV) | 71.43 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EgqQ3azqX1RIicWy_-P8QPsBJXRPmOGQ5ecc6DiG3S6m3g?e=LNA5dg);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EjOnqhJxbklNskZ8PLXQs4YBork9WBsOXpaMwI3VO9KxEQ?e=r2jxUG) |
| EuroSAT      | 65.41 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EkGLkzrGUW1GiMo65mB-XRgBoFr4E0L0HBeW8XvXefNMiQ?e=lRX5XY);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EopmWKfxAcRHne01pP2Wa7MBG-vXYKQkpiaEKfkBpYVGNw?e=m8GSry) | 76.80 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EtKmyFqcnr9BnM1u2uOYWtsBK-zkwuj3vWYGpto50XPDSw?e=bUeumu);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EsxABlaNKBtNkr2tYgKAls8B4t5AjRqs06wGKsEo6QOg4Q?e=052dE9) | 83.21 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EmjARwWZYmtPtYkf2XFFFz8BWFcxPUB1KsF4nnUY4Nikkw?e=xX2yP9);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EtC4O5gbM6FOhXKvBjr1FpkBbfR1HZnJeWsYgCSnn2G6Eg?e=rJshRt) | 88.37 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EuMt5NPwXKpEp-pFTS1dt-IBR-0m0PWwrc2ORSb69NMeRg?e=zdd6nT);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EgtgnfYmJHZOpSSr5qBJSncBC-muEp_6ezFECJaKr6U6HQ?e=wxgPej) | 92.00 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EvPPKX4YYTZLsogb6gRTfBYBZxpq9lIOsAD5DJhdrVIPUw?e=Twv4oz);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EpfCrIpsie9PoSHCyZDSOC4BX6Clgvf4KnxT5frmUdPKSw?e=74gdQ4) |
| FGVCAircraft | 28.60 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EjLnD9GmlHRKhxVDryJ59oABXQD1i7_hU3lmjkhXgdqB-w?e=PvwiLc);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EpfkdWe4FT5LoW4nQWbNTrEB6wr7dUWP0SK5D43mPai-EA?e=ymGagD) | 31.14 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EnpEFaV286hCgFSArDICsW4BKmNy6A3cLaJlTJAzo2Ivkw?e=YYMms0);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErNhs9cqhvlLkBfzR9AYyVQBHmKd_T4VOvHaYSQgFE_lfA?e=XJi8A6) | 35.29 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ElvKqaA4pXhAtyKH8DVmkEABu5IMrcDRNJYTLmc0SlbU9g?e=PEseD0);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErJb0yNeygpNu2sQ2YaFywoB1_H5uoH_FMG0RYfsHVN67g?e=Vo8UKh) | 41.42 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EvyvQ9qG5mFCmZwQ7PcJsgYBuutojsLjng8p_o9d3cDPNA?e=9ZzAs5);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EhWrjWptgdlEkFdydTy1HD4BRekvx8eGHBwNYf8OIse0hg?e=Pd5Q47) | 46.74 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EmXXClthgRJAk3TlGB1yfIABgQRaPVTQEfEWIPY4tDQSBg?e=XPKZB1);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EobTql6TIuJKo6NTSxOn9gYBOwVvjtjqAJ5B5RbZBNpWkA?e=BPjvXW) |
| Flowers102   | 80.48 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ej8I48AedQVAmor-WPjawO0BuJlxlviYu2mMrmHNAdze-g?e=go9Lx7);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EpvvwZF4b39MpViCsIW8obYBem5cAeDDeN9MnW8GQxjKsw?e=sbeP1E) | 89.81 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eg0C9qVXI2JHqRtLxHFEQRgBvN9rWF0U93PCIthRClwX8w?e=R1CilC);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ep993ztgrMRBhlMckrByosUBa9_7zFO5mH-2j0xm6dtnIA?e=cg1c6O) | 92.93 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EuQkXGKeEw9CqwI5G50w5HsBhrxGFo_SxnAdmid1C5b6mw?e=UWHUSK);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eje-NnJxkpJAt2ycaMTCsYEBVzLr9sOjBNASmktqaLm_qA?e=IL1JTr) | 95.44 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErjTer2AETFNi_LubPnRtSUBgmYnQOvzZ7FZTjC5AO90xA?e=SYBO2x);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EtkXtZ0iRHdIt10mr22x1nUBOz47zYzQMcr9gtwtNqT2cA?e=VsBC4N) | 97.56 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ellu7RQIViBMr6Pmv0osYz8BoFLugECBeDLq7ayQRhwi2g?e=7RkCeg);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EkCZovxStEJCrPY3DPc32HUBobXbTMZY1VIrzzGMM1DWrg?e=EaE1bI) |
| FOOD101      | 86.16 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Emx5c3hdO-NEr-RXVy5j_awB-U5aDLnoEq7_IX0Huiksjw?e=Low4Az);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EtMsguqMM7VHlEgOPEhuW1EBdCsNclCTSCX5dJclJ1jWZw?e=MZpUVr) | 86.33 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EobUjFGuH_NDpIa_T7QACLoBOsQcWYoyE5y9Cte8HPBQ_w?e=aNsbE7);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EnTDWXoeSYNOiLdZzXu_bkQBu2DDVcwYuW8slrZtdRR7Hg?e=D8Rq0X) | 86.46 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EjNq-K_XXlhBouoWfxHz9vMB8EQ6b7T00wBCPUJml1cbRg?e=8mgHE2);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Er6F14PalNxJnNYFIGicLKgBaEDi6BA703w-z74DALpmIQ?e=MEY5Aj) | 86.58 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EqDkliEX1stPiQEdR58gQ-MBoyCZOSvFp0kIom2RlW8ajw?e=t77HZJ);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ep574-BZQ1BLi29ZE8ThTUEBFejUX8S5YVPDi5Dosciq8g?e=qSIgeF) | 87.11 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ElgJT2qHsExGj_sSNyDP2PQBxyIFGVRfSLlKQjgsZCg2Yg?e=LRYacx);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EnmNa-a5yLxDqOzGvllVFwgBqr_mtRb1jpC3Vi2naJh8eQ?e=EoC8ze) |
| ImageNet     | 66.45 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eo2haM9Hr1pLsrSx3b1skboBR6TQ8tlpusOaGwC8EGTC4g?e=RjU3pV);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EqlUDuIq0KNGihIMh2e4B5oBl7X7ac9ZH7CSQBBGH0ZIxw?e=BK9vT5) | 68.28 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eho6wg0SODxKkPVdFo-IqXQBlXXJ-x2BaFztESDobWiFyA?e=31eomY);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ekq0tX6dWV1Cg7gZ3yZqZ88Bj5SeQI-ycdX72v8CdQ34IA?e=upoOsy) | 70.40 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EgOFphAOEOpHozynjKdEf5kB_jzgQzfd0wDMtQ72xB8V-g?e=q8pRFd);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErpnQAVdca5KqHNXC_aMvfgB5sT1T2fHI0Jrb4HMsYnxwA?e=r0CQvJ) | 71.31 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EnLZG1Po36JPtbuRXxapXj0BeE4yRSG_qY808I2qdklkUg?e=avxhQd);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EiO4N_UYYd9HrWYBjVmfMcoBEMQGYzCA5Ytvlo5j3qM70A?e=6Qs5fp) | 72.60 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EjReptc2vrlImzmnAK0VMaoBWt5iZ_yxnewcnOjJLKcW9A?e=ejbBhl);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Evu8NZ8KvElEga2GXddR3SkBmRPSnAzFyDS61tBmzMUYyA?e=5n1z2l) |
| OxfordPets   | 91.89 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Enwk3FwlgKdLvTkajEmOkv8Bo8Fgj6fbl96b5Ir1e_L-xQ?e=EMXbkd);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ehs4N6nIhf9EpuvnZRP8S0gBFeFwIR-jK3LRZwAYitDFHw?e=coWvbi) | 92.29 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eux-e0Kb-4pJvcfKRuNN294BCawXmFKT3vTn7Szdz8v7sA?e=SG7hHf);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EsGfWclvsjZMm-e2q4r8QwoBAXy2J6cwiW3gCQrwRiccPA?e=JRhWgS) | 92.55 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Er1uQssdQt9EhVHDLzh6hF0Be8FcbBYJzZUlpbUikx80SQ?e=wk4BgP);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EgGYTm6tuK5IgjSPjWm5dnIBNZnYL-GXsPJMKV0CpN3rQA?e=f9lROp) | 93.02 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Esewz9GLtu1Iicax_b-KtdwB88DVttSxi2D4gyBMp1biSQ?e=rYgZAp);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErD7Yjed3RVCvu-a9XIaiW8B5TVqSBDb1WUeBTjfqF9XxQ?e=zSWG1w) | 93.59 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ej3u3SH1DoROtTYmDoO09DABae56yefZjWlOcg7oZA4oeg?e=NuBgJk);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EuhlAz1GP1hIrc7KYfjjyhoBN7BFo0T0cAThTuQePw872Q?e=F2ZmQj) |
| StanfordCars | 68.81 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EndVYEUcnRlDvQBW3jh7RRcBeVMgcmF3Rq1nFpo52rc3qA?e=TAguM8);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EgHpqSmLWf9Onc5kTxLKhzwBi5L1ba9eZbCexDBSLW27WA?e=AgEAqk) | 73.17 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Etc0ioQeb41FtCslgANVbVYBdEGUQw0B3HiLQ4YDzNdqqw?e=374bYS);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EqMILcusqfJLtcVEDnnDL8wBZalMiZGGcB6664U7FxxCwQ?e=6tobBU) | 76.25 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eg7w6P3euq5Nvvm6JzmRBGYB_2SUo6RlF_bTBtbDy1oQzQ?e=F9oZTa);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EjL2HT9f3K9HndVY8Vlf34sBEpxbH8ddqZIRptTfJQVX4Q?e=LxVkgM) | 81.26 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/En-qP6tv61FCrb7wntWfW8QBS4iLMyNcnWuuJG57Mff-AQ?e=G8oi4A);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eox217dfnDFPl1VX7LgX638BnvKDUQZsDNWL598l2KOZ6g?e=Hqi8Qu) | 84.55 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EjXJfOnaKYZMoOUk8Qn1H0MBxN2dMuAHQc_QGewE3H5QUw?e=vyV4sp);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ElXRj5VJW79IuAk_6noCgpsBAE4VKK1kF7K_Z8LYXbFd6Q?e=wJY4ga) |
| SUN397       | 66.77 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Eox7-PHkpS9Kj3At3F9kOIgBo55a6rlMztK0WVmb8AqH6Q?e=LsmjKU);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EkRj26hWy8ZJqr0XsQ0Pn3IB09Qsd762Dhw1M0dmosztnQ?e=ANIR8n) | 68.06 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EirZulcM6NtIlXov02Nsr0gB_qFwH7QQAa4e7F7Gf3kYyg?e=xRVKVu);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EmGOkVw2QWhBujzLwWZ7-qsBYspdaQmch2ckT0MK0nnH4A?e=htuctW) | 71.73 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ej-_h7r1F29CleIBPQuITFMBwbg91gQ0e3y1mHYh8PFjvg?e=0Mc1IR);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EqE2REbBrHZHikp-g9nJU0kBStvrXWIHZvzudiXC56kggw?e=EEbIIv) | 73.93 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EnG8rEdAfctFgcxAABKkTu0BtD-6gbBVgBOteTbV7jF0Ng?e=jbgdYg);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EiDjplhpNa5AvlIuKjuKC-UBHRbeMXhnBomRIMjT9zS8iw?e=YBB7vL) | 76.03 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Euv47CP62nhGj9fOp4sfuogB_Ha8sp9EzVAQ0mFseAOakg?e=y62ZVp);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EvM4o7r0sJtGnjSOr7bDpfsByJhZvfggCyC6mTt8j5dYWg?e=UZD8GE) |
| UCF101       | 74.31 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EuQBIPsyRl5Epyi91thplp8BXS5qF1l3DubH9sN9vOS_1g?e=N7zsSF);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ejvmhd_Pj81AvszswfxYHeMBpq5uV17vlfge6lM2iH_0Tw?e=TPOz93) | 76.76 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/Ekj3_hs2t9BJmG-FQ8EjyT4BYnTAj0iJp7k5qtpanK48QQ?e=BB5FCt);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EpqAQvlPNtZErn7tGp_Yo78BrZ0FjUqblK5GwekU-PbC7g?e=0fe3tZ) | 79.76 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/El7mhpsQQsZMkTdqTYrKs6IBDChbLhLSMhQkYsBAalty1A?e=Muj1kh);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErU_5p1bw6JOtrnBHb4Ku8ABrDAJDMtqwu2U3I0ouTqORw?e=Ekp3T8) | 82.80 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EpgV8HYNO4dHh5B0f3kEPHsBKF8ZKCgzYFMLRy1HT4YAfQ?e=RZBzuV);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EozWJwtFDwxFj1V-gDM22d4BAz1WL9KDpIiA-Iv_NxW-HQ?e=2THhhJ) | 85.34 | [stage1](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/ErQiI63suyxHudd8ckE3sCoBNi-h2vCwPBjbdjCqZvSQfg?e=iJCvKn);[stage2](https://mbzuaiac-my.sharepoint.com/:f:/g/personal/zhengqing_gao_mbzuai_ac_ae/EmSXXPW8-iVHs1Ax-eAGKdkBc-OaBbplSg3cKVHFpcSWww?e=K9b2OV) |

You can use `/scripts/evaluation.sh` to evaluate `PLOT++` by loading our released models from links shown above, whose structure is

```
plot++_models
|–– caltech101/
|   |–– 1shots/
|   |   |–– stage1/
|   |–– |–– |–– seed1/
|   |   |–– stage2/
|   |   |–– |–– seed1/
|   |   |–– |–– seed2/
|   |   |–– |–– seed3/
```

To evaluate the first-stage models, you should firstly gain the stage1 model, and store it in `your_pretrain_path`, change `your_data_path`, `your_pretrain_path` and `your_work_path` in `scripts/evaluation.sh`, then you can run the command `bash evaluation.sh DATASET 4` under `plot-pp/scripts/`. For example `bash evaluation.sh imagenet 4`. To evaluate the stage2 models, you should firstly gain the second-stage model and repeat what you do when evaluating the first-stage model.
